---
title: "Proyecto 1 – Maternidad Adolescente en Guatemala (2009–2023)"
author: "Grupo 6"
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1. Introducción

Guatemala presenta históricamente altas tasas de maternidad adolescente, fenómeno asociado a desigualdades territoriales y educativas.

Este proyecto analiza la evolución y distribución territorial de los nacimientos en madres menores de 18 años utilizando registros oficiales del Instituto Nacional de Estadística (INE) correspondientes al período 2009–2023.

Preguntas de investigación:

- ¿Ha disminuido o aumentado la proporción de nacimientos en madres menores de 18 años entre 2009 y 2023?
- ¿Se concentra más en áreas rurales?
- ¿Existe relación entre nivel educativo y maternidad temprana?
- ¿Hay departamentos con patrones extremos?
- ¿El fenómeno presenta agrupamiento territorial?

---

# 2. Descripción General del Conjunto de Datos

El conjunto de datos corresponde a registros individuales de nacimientos del INE.

- Número total de observaciones: 5,195,195
- Número de variables originales: 61
- Periodo: 2009–2023

Principales variables utilizadas:

| Variable | Descripción | Tipo |
|----------|------------|------|
| Añoreg | Año de registro | Numérica |
| Edadm | Edad de la madre | Numérica |
| Areag | Área geográfica (1=Urbano, 2=Rural) | Categórica |
| Escivm | Nivel educativo madre | Categórica |
| Deprem | Departamento de residencia | Categórica |

---

# 3. Carga y Unión de Datos

```{r carga_datos}
library(haven)
library(dplyr)
library(ggplot2)
library(cluster)
library(factoextra)

archivos <- list.files("Datos", pattern = "\\.sav$", full.names = TRUE)

lista_datos <- lapply(archivos, function(x) {
  df <- read_sav(x)
  df <- zap_labels(df)
  df[] <- lapply(df, as.character)
  df
})

datos_unidos <- bind_rows(lista_datos)

length(archivos)
dim(datos_unidos)
```

---

# 4. Limpieza y Preparación

## Corrección del año

```{r year_fix}
datos_unidos$Añoreg <- ifelse(nchar(datos_unidos$Añoreg) == 1,
                              paste0("200", datos_unidos$Añoreg),
                              ifelse(nchar(datos_unidos$Añoreg) == 2,
                                     paste0("20", datos_unidos$Añoreg),
                                     datos_unidos$Añoreg))

datos_unidos$Añoreg <- as.numeric(datos_unidos$Añoreg)
table(datos_unidos$Añoreg)
```

## Limpieza de edad materna

```{r edad_limpia}
datos_unidos$Edadm <- as.numeric(datos_unidos$Edadm)
datos_unidos$Edadm[datos_unidos$Edadm == 999] <- NA
summary(datos_unidos$Edadm)
```

## Variable maternidad adolescente

```{r adolescente}
datos_unidos$adolescente <- ifelse(datos_unidos$Edadm < 18, 1, 0)
table(datos_unidos$adolescente)
```

---

# 5. Análisis Exploratorio

## 5.1 Distribución de Edad Materna

```{r dist_edad}
ggplot(datos_unidos, aes(x = Edadm)) +
  geom_histogram(bins = 30) +
  labs(title = "Distribución de Edad Materna",
       x = "Edad",
       y = "Frecuencia")
```

---

## 5.2 Evolución Temporal

```{r evolucion}
prop_anual <- datos_unidos %>%
  group_by(Añoreg) %>%
  summarise(prop_adolescente = mean(adolescente, na.rm = TRUE))

ggplot(prop_anual, aes(x = Añoreg, y = prop_adolescente)) +
  geom_line() +
  geom_point() +
  labs(title = "Evolución de la Maternidad Adolescente",
       x = "Año",
       y = "Proporción")
```

---

## 5.3 Urbano vs Rural

```{r ruralidad}
datos_unidos$Areag <- as.numeric(datos_unidos$Areag)
datos_unidos$Areag[datos_unidos$Areag == 9] <- NA

prop_area <- datos_unidos %>%
  filter(!is.na(Areag)) %>%
  group_by(Areag) %>%
  summarise(prop_adolescente = mean(adolescente, na.rm = TRUE))

prop_area
```

---

## 5.4 Nivel Educativo

```{r educacion}
datos_unidos$Escivm <- as.numeric(datos_unidos$Escivm)
datos_unidos$Escivm[datos_unidos$Escivm == 9] <- NA

prop_educ <- datos_unidos %>%
  filter(!is.na(Escivm)) %>%
  group_by(Escivm) %>%
  summarise(prop_adolescente = mean(adolescente, na.rm = TRUE))

prop_educ
```

---

## 5.5 Departamentos con Patrones Extremos

```{r deptos}
datos_unidos$Deprem <- as.numeric(datos_unidos$Deprem)
datos_unidos$Deprem[datos_unidos$Deprem == 99] <- NA

prop_depto <- datos_unidos %>%
  filter(!is.na(Deprem)) %>%
  group_by(Deprem) %>%
  summarise(prop_adolescente = mean(adolescente, na.rm = TRUE)) %>%
  arrange(desc(prop_adolescente))

head(prop_depto)
tail(prop_depto)
```

---

# 6. Construcción Dataset para Clustering

```{r agregacion}
datos_cluster <- datos_unidos %>%
  filter(!is.na(Deprem)) %>%
  group_by(Deprem) %>%
  summarise(
    prop_adolescente = mean(adolescente, na.rm = TRUE),
    prop_rural = mean(Areag == 2, na.rm = TRUE),
    edad_promedio = mean(Edadm, na.rm = TRUE),
    prop_baja_educ = mean(Escivm == 1, na.rm = TRUE)
  )

datos_cluster
```

---

# 7. Estandarización

```{r escalado}
datos_scaled <- scale(datos_cluster[, -1])
```

---

# 8. Método del Codo

```{r elbow}
fviz_nbclust(datos_scaled, kmeans, method = "wss")
```

---

# 9. Clustering K-means

```{r kmeans}
set.seed(123)
kmeans_model <- kmeans(datos_scaled, centers = 3, nstart = 25)

datos_cluster$cluster <- kmeans_model$cluster
datos_cluster
```

---

# 10. Validación con Silhouette

```{r silhouette}
sil <- silhouette(kmeans_model$cluster, dist(datos_scaled))
fviz_silhouette(sil)
```

---

# 11. Interpretación de Resultados

## Evolución temporal de la maternidad adolescente

El análisis de la proporción anual de nacimientos en madres menores de 18 años muestra un comportamiento no lineal durante el período 2009–2023.

Se observa un incremento progresivo entre 2009 y 2012, alcanzando un punto máximo cercano al 10.7%. A partir de 2013 se identifica una tendencia descendente relativamente sostenida, con una caída más marcada en 2020 (aproximadamente 7.3%). Este descenso podría estar asociado a cambios estructurales en políticas públicas o a efectos indirectos derivados de la pandemia.

En 2023 se observa un leve repunte, lo cual sugiere que el fenómeno no ha desaparecido y mantiene cierta persistencia estructural.

En términos generales, la tendencia indica una reducción moderada respecto al pico observado en 2012, aunque la proporción continúa siendo significativa.

---

## Comparación Urbano vs Rural

Contrario a lo que suele asumirse, la diferencia entre áreas urbanas y rurales es mínima:

- Urbano: 9.53%
- Rural: 9.49%

Esto sugiere que la maternidad adolescente no es un fenómeno exclusivamente rural, sino que se presenta con intensidad similar en ambos contextos. El fenómeno parece responder a factores estructurales más complejos que trascienden la simple división territorial.

---

## Relación con Nivel Educativo

El análisis por nivel educativo muestra un patrón claro y estructural:

- Nivel educativo bajo: 12.6%
- Nivel intermedio: 3.28%
- Nivel alto: 1.43%

Se observa una relación inversa fuerte entre educación y maternidad adolescente. A menor nivel educativo, mayor proporción de maternidad temprana.

Este resultado evidencia que el nivel educativo es uno de los factores más determinantes asociados al fenómeno.

---

## Departamentos con Patrones Extremos

El análisis territorial permitió identificar departamentos con proporciones significativamente mayores y menores de maternidad adolescente.

Algunos departamentos superan el 12%, mientras que otros se encuentran por debajo del 5%. Estas diferencias reflejan desigualdades estructurales territoriales asociadas a condiciones socioeducativas y demográficas.

---

# 12. Clustering Territorial

Para profundizar en la estructura territorial del fenómeno, se construyó un dataset agregado por departamento incorporando:

- Proporción de maternidad adolescente
- Proporción de ruralidad
- Edad promedio materna
- Proporción de baja educación

Tras estandarizar las variables y aplicar el algoritmo K-means con k = 3, se identificaron tres grupos territoriales diferenciados. El índice promedio de silhouette fue 0.42, lo cual indica una estructura de agrupamiento aceptable.

## Interpretación de los Clusters

**Cluster 1 – Alta ruralidad y perfil intermedio**

Departamentos con alta proporción rural y niveles intermedios de maternidad adolescente.

**Cluster 2 – Perfil urbano con menor maternidad adolescente**

Departamentos con menor ruralidad y menores proporciones de maternidad adolescente.

**Cluster 3 – Alta vulnerabilidad estructural**

Departamentos con mayor proporción de maternidad adolescente y mayor proporción de baja educación.

---

# 13. Conclusión General

El análisis realizado permite concluir que:

1. La maternidad adolescente mostró un incremento inicial hasta 2012 y posteriormente una tendencia descendente.
2. La diferencia urbano-rural es menor a la esperada.
3. El nivel educativo presenta una relación estructural clara con la maternidad temprana.
4. Existen diferencias territoriales significativas entre departamentos.
5. El clustering confirma la existencia de perfiles territoriales diferenciados.

Las preguntas de investigación planteadas fueron respondidas mediante el análisis exploratorio y el agrupamiento territorial realizado.
